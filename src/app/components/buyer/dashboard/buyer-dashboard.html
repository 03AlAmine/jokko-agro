<div class="dashboard-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="user-info">
        <div class="avatar">
          {{ userData?.fullName?.charAt(0) || 'A' }}
        </div>
        <div class="user-details">
          <h3>{{ userData?.fullName || 'Acheteur' }}</h3>
          <p class="role-badge">ğŸ›’ Acheteur</p>
        </div>
      </div>
    </div>

    <nav class="sidebar-nav">
      <a routerLink="/buyer/dashboard" class="nav-item active">
        <span class="nav-icon">ğŸ“Š</span>
        Tableau de bord
      </a>
      <a routerLink="/buyer/market" class="nav-item">
        <span class="nav-icon">ğŸ›ï¸</span>
        MarchÃ©
      </a>
      <a routerLink="/buyer/scan" class="nav-item">
        <span class="nav-icon">ğŸ“±</span>
        Scanner QR
      </a>
      <a routerLink="/buyer/cart" class="nav-item">
        <span class="nav-icon">ğŸ›’</span>
        Panier
        <span class="badge">2</span>
      </a>
      <a routerLink="/buyer/purchases" class="nav-item">
        <span class="nav-icon">ğŸ“‹</span>
        Historique
      </a>
      <a routerLink="/buyer/verifications" class="nav-item">
        <span class="nav-icon">âœ…</span>
        VÃ©rifications
      </a>
      <a routerLink="/buyer/messages" class="nav-item">
        <span class="nav-icon">âœ‰ï¸</span>
        Messages
      </a>
      <a routerLink="/buyer/favorites" class="nav-item">
        <span class="nav-icon">â¤ï¸</span>
        Favoris
      </a>
      <a routerLink="/buyer/settings" class="nav-item">
        <span class="nav-icon">âš™ï¸</span>
        ParamÃ¨tres
      </a>
    </nav>

    <div class="sidebar-footer">
      <button class="logout-btn" (click)="logout()">
        <span class="nav-icon">ğŸšª</span>
        DÃ©connexion
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="main-header">
      <div class="header-left">
        <h1>Bienvenue sur le marchÃ©</h1>
        <p class="welcome-text">DÃ©couvrez des produits frais et certifiÃ©s prÃ¨s de chez vous</p>
      </div>
      <div class="header-right">
        <div class="search-box">
          <input type="text" placeholder="Rechercher un produit...">
          <button class="search-btn">ğŸ”</button>
        </div>
        <div class="quick-actions">
          <button routerLink="/buyer/scan" class="quick-btn">
            ğŸ“± Scanner QR
          </button>
        </div>
      </div>
    </header>

    <!-- Stats Grid -->
    <div class="stats-grid">
      <div
        *ngFor="let stat of stats"
        class="stat-card"
        [routerLink]="stat.link"
        [ngStyle]="{borderLeftColor: stat.color}"
      >
        <div class="stat-icon" [ngStyle]="{backgroundColor: stat.color + '20'}">
          {{ stat.icon }}
        </div>
        <div class="stat-info">
          <h3>{{ stat.value }}</h3>
          <p>{{ stat.label }}</p>
        </div>
      </div>
    </div>

    <!-- Categories -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2>CatÃ©gories populaires</h2>
        <a routerLink="/buyer/market" class="view-all">Tout voir â†’</a>
      </div>

      <div class="categories-grid">
        <div *ngFor="let category of categories" class="category-card">
          <div class="category-icon">{{ category.icon }}</div>
          <h4>{{ category.name }}</h4>
          <p>{{ category.count }} produits</p>
        </div>
      </div>
    </div>

    <!-- Recent Purchases -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2>Achats rÃ©cents</h2>
        <a routerLink="/buyer/purchases" class="view-all">Voir tout â†’</a>
      </div>

      <div class="table-container">
        <table class="purchases-table">
          <thead>
            <tr>
              <th>Commande</th>
              <th>Produit</th>
              <th>Producteur</th>
              <th>Date</th>
              <th>Montant</th>
              <th>Statut</th>
              <th>CertifiÃ©</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let purchase of recentPurchases">
              <td>#{{ purchase.id }}</td>
              <td class="product-cell">{{ purchase.product }}</td>
              <td>{{ purchase.producer }}</td>
              <td>{{ purchase.date }}</td>
              <td class="amount">{{ formatPrice(purchase.amount) }}</td>
              <td>
                <span class="status-badge" [ngStyle]="{backgroundColor: getStatusColor(purchase.status)}">
                  {{ getStatusText(purchase.status) }}
                </span>
              </td>
              <td>
                <span *ngIf="purchase.certified" class="certified-badge">âœ… CertifiÃ©</span>
                <span *ngIf="!purchase.certified" class="not-certified">Non certifiÃ©</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Recommended Products -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2>Produits recommandÃ©s</h2>
        <p class="section-subtitle">BasÃ© sur vos achats prÃ©cÃ©dents</p>
      </div>

      <div class="products-grid">
        <div *ngFor="let product of recommendedProducts" class="product-card">
          <div class="product-image">
            {{ product.image }}
            <span *ngIf="product.certified" class="certified-tag">âœ” CertifiÃ©</span>
          </div>
          <div class="product-info">
            <h4>{{ product.name }}</h4>
            <p class="producer">{{ product.producer }}</p>
            <div class="product-meta">
              <span class="price">{{ formatPrice(product.price) }}</span>
              <span class="rating">â­ {{ product.rating }}</span>
            </div>
            <button class="add-to-cart">Ajouter au panier</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Tips Section -->
    <div class="tips-section">
      <div class="tip-card">
        <h3>ğŸ’¡ Pourquoi choisir des produits certifiÃ©s ?</h3>
        <ul>
          <li>âœ… TraÃ§abilitÃ© garantie</li>
          <li>âœ… QualitÃ© vÃ©rifiÃ©e</li>
          <li>âœ… Soutien aux producteurs locaux</li>
          <li>âœ… FraÃ®cheur assurÃ©e</li>
        </ul>
      </div>
      <div class="tip-card">
        <h3>ğŸ“± Comment scanner un QR code ?</h3>
        <ol>
          <li>Ouvrez l'application</li>
          <li>Cliquez sur "Scanner QR"</li>
          <li>Pointez sur le code du produit</li>
          <li>VÃ©rifiez les informations</li>
        </ol>
        <button routerLink="/buyer/scan" class="scan-btn">
          Essayer maintenant
        </button>
      </div>
    </div>
  </main>

  <!-- Assistant vocal -->
  <app-voice-assistant />
</div>
