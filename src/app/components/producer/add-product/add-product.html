<div class="add-product-container">

  <!-- Main Content -->
  <main class="main-content">
    <div class="form-container">
      <!-- En-t√™te -->
      <div class="form-header">
        <h1><span class="header-icon">‚ûï</span> Ajouter un nouveau produit</h1>
        <p class="subtitle">
          Remplissez les informations de votre produit pour le mettre en vente
        </p>
      </div>

      <!-- Formulaire -->
      <form
        [formGroup]="productForm"
        (ngSubmit)="onSubmit()"
        class="product-form"
      >
        <!-- Section 1: Informations de base -->
        <div class="form-section">
          <h2 class="section-title">üìã Informations de base</h2>

          <div class="form-row">
            <div class="form-group">
              <label for="name">Nom du produit *</label>
              <input
                type="text"
                id="name"
                formControlName="name"
                placeholder="Ex: Tomates bio"
                [class.error]="productForm.get('name')?.invalid && productForm.get('name')?.touched"
              />
              <div
                class="error-message"
                *ngIf="productForm.get('name')?.invalid && productForm.get('name')?.touched"
              >
                Le nom du produit est requis (minimum 3 caract√®res)
              </div>
            </div>

            <div class="form-group">
              <label for="category">Cat√©gorie *</label>
              <div class="select-wrapper">
                <select
                  id="category"
                  formControlName="category"
                  [class.error]="productForm.get('category')?.invalid && productForm.get('category')?.touched"
                >
                  <option value="">S√©lectionnez une cat√©gorie</option>
                  <option
                    *ngFor="let category of categories"
                    [value]="category.id"
                  >
                    {{ category.icon }} {{ category.name }}
                  </option>
                </select>
              </div>
              <div
                class="error-message"
                *ngIf="productForm.get('category')?.invalid && productForm.get('category')?.touched"
              >
                Veuillez s√©lectionner une cat√©gorie
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="description">Description d√©taill√©e *</label>
            <textarea
              id="description"
              formControlName="description"
              rows="4"
              placeholder="D√©crivez votre produit (qualit√©, fra√Æcheur, avantages...)"
              [class.error]="productForm.get('description')?.invalid && productForm.get('description')?.touched"
            ></textarea>
            <div class="char-count">
              {{ productForm.get('description')?.value?.length || 0 }}/500
              caract√®res
            </div>
            <div
              class="error-message"
              *ngIf="productForm.get('description')?.invalid && productForm.get('description')?.touched"
            >
              La description est requise (minimum 10 caract√®res)
            </div>
          </div>
        </div>

        <!-- Section 2: Prix et Quantit√© -->
        <div class="form-section">
          <h2 class="section-title">üí∞ Prix et Quantit√©</h2>

          <div class="form-row">
            <div class="form-group">
              <label for="price">Prix unitaire (FCFA) *</label>
              <div class="input-with-icon">
                <span class="input-icon">‚Ç£</span>
                <input
                  type="number"
                  id="price"
                  formControlName="price"
                  min="100"
                  placeholder="1500"
                  [class.error]="productForm.get('price')?.invalid && productForm.get('price')?.touched"
                />
              </div>
              <div
                class="error-message"
                *ngIf="productForm.get('price')?.invalid && productForm.get('price')?.touched"
              >
                Le prix minimum est 100 FCFA
              </div>
            </div>

            <div class="form-group">
              <label for="quantity">Quantit√© *</label>
              <input
                type="number"
                id="quantity"
                formControlName="quantity"
                min="1"
                placeholder="10"
                [class.error]="productForm.get('quantity')?.invalid && productForm.get('quantity')?.touched"
              />
              <div
                class="error-message"
                *ngIf="productForm.get('quantity')?.invalid && productForm.get('quantity')?.touched"
              >
                La quantit√© minimum est 1
              </div>
            </div>

            <div class="form-group">
              <label for="unit">Unit√© de mesure *</label>
              <div class="select-wrapper">
                <select
                  id="unit"
                  formControlName="unit"
                  [class.error]="productForm.get('unit')?.invalid && productForm.get('unit')?.touched"
                >
                  <option *ngFor="let unit of units" [value]="unit.id">
                    {{ unit.symbol }} ({{ unit.name }})
                  </option>
                </select>
              </div>
            </div>
          </div>

          <!-- Prix total estim√© -->
          <div
            class="estimated-price"
            *ngIf="productForm.get('price')?.value && productForm.get('quantity')?.value"
          >
            <div class="estimated-label">
              <span class="icon">üí∞</span>
              <span>Valeur totale estim√©e :</span>
            </div>
            <div class="estimated-value">
              {{ calculateEstimatedPrice().toLocaleString() }} FCFA
            </div>
          </div>
        </div>

        <!-- Section 3: Images -->
        <div class="form-section">
          <h2 class="section-title">üì∏ Photos du produit</h2>
          <p class="section-subtitle">
            Ajoutez des photos de qualit√© pour attirer plus d'acheteurs
          </p>

          <div class="image-upload-area" [class.has-image]="imagePreview">
            <div
              *ngIf="!imagePreview"
              class="upload-placeholder"
              (click)="triggerFileInput()"
            >
              <div class="upload-icon">üì∑</div>
              <p>Cliquez pour ajouter une photo</p>
              <p class="upload-hint">Formats accept√©s: JPG, PNG ‚Ä¢ Max: 5MB</p>
            </div>

            <div
              *ngIf="!imagePreview"
              class="upload-placeholder"
              (click)="triggerFileUpload()"
            >
              <div class="upload-icon">üì∑</div>
              <p>Cliquez pour ajouter une photo</p>
              <p class="upload-hint">Formats accept√©s: JPG, PNG ‚Ä¢ Max: 5MB</p>
            </div>

            <div *ngIf="imagePreview" class="image-preview">
              <img [src]="imagePreview" alt="Aper√ßu du produit" />
              <button
                type="button"
                class="remove-image"
                (click)="removeImage()"
              >
                √ó Supprimer
              </button>
            </div>
          </div>

          <div class="upload-tips">
            <p>üí° <strong>Conseils pour de belles photos :</strong></p>
            <ul>
              <li>Prenez la photo sous un bon √©clairage</li>
              <li>Montrez le produit sous diff√©rents angles</li>
              <li>Utilisez un fond neutre</li>
              <li>√âvitez les photos floues</li>
            </ul>
          </div>
        </div>

        <!-- Section 4: Certifications et qualit√©s -->
        <div class="form-section">
          <h2 class="section-title">‚úÖ Certifications et qualit√©s</h2>

          <div class="certifications-grid">
            <div
              *ngFor="let cert of certifications"
              class="certification-card"
              [class.selected]="isCertificationSelected(cert.id)"
              (click)="toggleCertification(cert.id)"
            >
              <div class="cert-checkbox">
                <div
                  class="checkbox"
                  [class.checked]="isCertificationSelected(cert.id)"
                ></div>
              </div>
              <div class="cert-content">
                <h4>{{ cert.name }}</h4>
                <p>{{ cert.description }}</p>
              </div>
            </div>
          </div>

          <div class="form-group checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" formControlName="isOrganic" />
              <span class="checkbox-custom"></span>
              <span class="checkbox-text"
                >üå± Ce produit est issu de l'agriculture biologique</span
              >
            </label>
          </div>
        </div>

        <!-- Section 5: Informations suppl√©mentaires -->
        <div class="form-section">
          <h2 class="section-title">üìù Informations suppl√©mentaires</h2>

          <div class="form-row">
            <div class="form-group">
              <label for="harvestDate">Date de r√©colte</label>
              <input
                type="date"
                id="harvestDate"
                formControlName="harvestDate"
              />
            </div>

            <div class="form-group">
              <label for="expirationDate">Date d'expiration</label>
              <input
                type="date"
                id="expirationDate"
                formControlName="expirationDate"
              />
            </div>
          </div>

          <div class="form-group">
            <label for="storageConditions">Conditions de conservation</label>
            <input
              type="text"
              id="storageConditions"
              formControlName="storageConditions"
              placeholder="Ex: Conserver au frais, √† l'abri de la lumi√®re"
            />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="location">Lieu de production</label>
              <input
                type="text"
                id="location"
                formControlName="location"
                placeholder="Ex: Dakar, S√©n√©gal"
              />
            </div>

            <div class="form-group">
              <label for="contactPhone">Contact t√©l√©phonique</label>
              <input
                type="tel"
                id="contactPhone"
                formControlName="contactPhone"
                placeholder="77 123 45 67"
              />
            </div>
          </div>

          <div class="form-group">
            <label for="minOrderQuantity">Quantit√© minimale de commande</label>
            <input
              type="number"
              id="minOrderQuantity"
              formControlName="minOrderQuantity"
              min="1"
              placeholder="1"
            />
            <small
              >D√©finissez la quantit√© minimale que les acheteurs doivent
              commander</small
            >
          </div>
        </div>

        <!-- Boutons d'action -->
        <div class="form-actions">
          <button
            type="button"
            class="btn-secondary"
            routerLink="/producer/products"
          >
            Annuler
          </button>
          <button
            type="submit"
            class="btn-primary"
            [disabled]="isSubmitting || productForm.invalid"
          >
            <span *ngIf="!isSubmitting">
              <span class="btn-icon">‚ûï</span> Ajouter le produit
            </span>
            <span *ngIf="isSubmitting">
              <span class="spinner"></span> Ajout en cours...
            </span>
          </button>
        </div>

        <!-- Aide vocale -->
        <div class="voice-help">
          <p>üé§ <strong>Commandes vocales disponibles :</strong></p>
          <ul>
            <li>Dites <strong>"Ajouter"</strong> pour valider le formulaire</li>
            <li>Dites <strong>"Photo"</strong> pour ajouter une image</li>
            <li>Dites <strong>"Annuler"</strong> pour retourner en arri√®re</li>
          </ul>
        </div>
      </form>
    </div>
  </main>

</div>
