<!-- Nouveau design - add-product.component.html -->
<div class="add-product-container">
  <!-- Header am√©lior√© -->
  <header class="product-header">
    <div class="header-content">
      <div class="header-top">
        <button class="back-button" routerLink="/producer/products">
          <i class="back-icon">‚Üê</i>
          Retour aux produits
        </button>

        <div class="header-info">
          <h1 class="page-title">Ajouter un nouveau produit</h1>
          <p class="page-subtitle">Remplissez les informations pour mettre votre produit en vente</p>
        </div>
      </div>

      <!-- Progress bar verticale -->
      <div class="vertical-progress">
        <div class="progress-bar">
          <div class="progress-fill" [style.height.%]="completionPercentage"></div>
        </div>
        <div class="progress-info">
          <span class="progress-text">{{ completionPercentage }}% compl√©t√©</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Contenu principal -->
  <main class="main-content">
    <div class="form-wrapper">
      <!-- Navigation lat√©rale des √©tapes -->
      <aside class="form-sidebar">
        <div class="add-sidebar-header">
          <h3 class="add-sidebar-title">√âtapes de cr√©ation</h3>
          <p class="add-sidebar-subtitle">Suivez les √©tapes pour compl√©ter</p>
        </div>

        <nav class="steps-nav">
          <div *ngFor="let section of sections"
               class="step-item"
               [class.active]="currentSection === section.id"
               [class.completed]="isSectionCompleted(section.id)"
               (click)="goToSection(section.id)">
            <div class="step-marker">
              <div class="step-number">{{ section.number }}</div>
              <div class="step-status">
                <span *ngIf="isSectionCompleted(section.id)" class="completed-icon">‚úì</span>
              </div>
            </div>
            <div class="step-content">
              <h4 class="step-title">{{ section.title }}</h4>
              <p class="step-desc">{{ section.description }}</p>
            </div>
          </div>
        </nav>

        <!-- Aide rapide -->
        <div class="help-section">
          <div class="help-header">
            <i class="help-icon">üí°</i>
            <h4>Conseils rapides</h4>
          </div>
          <ul class="help-tips">
            <li>Utilisez des photos de qualit√©</li>
            <li>Soyez pr√©cis dans les descriptions</li>
            <li>Fixez un prix comp√©titif</li>
            <li>Indiquez toutes les certifications</li>
          </ul>
        </div>
      </aside>

      <!-- Formulaire principal -->
      <div class="form-content">
        <div class="content-container">
          <form [formGroup]="productForm">
            <!-- Section 1: Informations de base -->
            <section id="basic-info" class="form-section" [class.active]="currentSection === 'basic-info'">
              <div class="section-header">
                <div class="section-icon">üìã</div>
                <div class="section-title-group">
                  <h2 class="section-title">Informations de base</h2>
                  <p class="section-subtitle">Donnez une identit√© claire √† votre produit</p>
                </div>
              </div>

              <div class="form-grid">
                <!-- Nom du produit -->
                <div class="form-group">
                  <label for="name" class="form-label">
                    Nom du produit <span class="required">*</span>
                  </label>
                  <input type="text"
                         id="name"
                         formControlName="name"
                         placeholder="Ex: Tomates bio fra√Æches"
                         class="form-control"
                         [class.invalid]="showFieldError('name')">
                  <div class="form-hint">Un nom descriptif et attrayant</div>
                  <div *ngIf="showFieldError('name')" class="error-message">
                    <i class="error-icon">!</i>
                    Le nom doit contenir entre 3 et 100 caract√®res
                  </div>
                </div>

                <!-- Cat√©gorie -->
                <div class="form-group">
                  <label for="category" class="form-label">
                    Cat√©gorie <span class="required">*</span>
                  </label>
                  <div class="category-selector">
                    <select id="category"
                            formControlName="category"
                            class="form-control"
                            [class.invalid]="showFieldError('category')">
                      <option value="" disabled selected>S√©lectionnez une cat√©gorie</option>
                      <option *ngFor="let cat of categories" [value]="cat.id">
                        {{ cat.icon }} {{ cat.name }}
                      </option>
                    </select>
                    <i class="select-arrow">‚ñº</i>
                  </div>
                  <div *ngIf="showFieldError('category')" class="error-message">
                    <i class="error-icon">!</i>
                    S√©lectionnez une cat√©gorie
                  </div>
                </div>

                <!-- Description -->
                <div class="form-group full-width">
                  <label for="description" class="form-label">
                    Description d√©taill√©e <span class="required">*</span>
                  </label>
                  <div class="description-box">
                    <textarea id="description"
                              formControlName="description"
                              rows="6"
                              placeholder="D√©crivez votre produit avec pr√©cision (origine, qualit√©s, avantages...)"
                              class="form-control textarea"
                              [class.invalid]="showFieldError('description')"
                              (input)="updateDescriptionLength($event)"></textarea>
                    <div class="description-footer">
                      <div class="char-counter">
                        {{ descriptionLength }}/500 caract√®res
                      </div>
                      <div class="word-count">
                        {{ countWords(productForm.get('description')?.value) }} mots
                      </div>
                    </div>
                  </div>
                  <div *ngIf="showFieldError('description')" class="error-message">
                    <i class="error-icon">!</i>
                    La description doit contenir entre 10 et 500 caract√®res
                  </div>
                </div>
              </div>
            </section>

            <!-- Section 2: Prix et Quantit√© -->
            <section id="price-quantity" class="form-section" [class.active]="currentSection === 'price-quantity'">
              <div class="section-header">
                <div class="section-icon">üí∞</div>
                <div class="section-title-group">
                  <h2 class="section-title">Prix et Quantit√©</h2>
                  <p class="section-subtitle">D√©finissez votre offre commerciale</p>
                </div>
              </div>

              <div class="form-grid">
                <!-- Prix unitaire -->
                <div class="form-group">
                  <label for="price" class="form-label">
                    Prix unitaire <span class="required">*</span>
                  </label>
                  <div class="price-input">
                    <input type="number"
                           id="price"
                           formControlName="price"
                           min="100"
                           step="50"
                           placeholder="1500"
                           class="form-control"
                           [class.invalid]="showFieldError('price')"
                           (input)="updateEstimatedTotal()">
                    <span class="currency-label">FCFA</span>
                  </div>
                  <div class="form-hint">Prix recommand√©: 100 - 1,000,000 FCFA</div>
                  <div *ngIf="showFieldError('price')" class="error-message">
                    <i class="error-icon">!</i>
                    Prix invalide
                  </div>
                </div>

                <!-- Quantit√© -->
                <div class="form-group">
                  <label for="quantity" class="form-label">
                    Quantit√© disponible <span class="required">*</span>
                  </label>
                  <input type="number"
                         id="quantity"
                         formControlName="quantity"
                         min="1"
                         placeholder="100"
                         class="form-control"
                         [class.invalid]="showFieldError('quantity')"
                         (input)="updateEstimatedTotal()">
                  <div *ngIf="showFieldError('quantity')" class="error-message">
                    <i class="error-icon">!</i>
                    Quantit√© minimum: 1
                  </div>
                </div>

                <!-- Unit√© -->
                <div class="form-group">
                  <label for="unit" class="form-label">
                    Unit√© de mesure <span class="required">*</span>
                  </label>
                  <div class="unit-grid">
                    <div *ngFor="let unit of units"
                         class="unit-option"
                         [class.selected]="productForm.get('unit')?.value === unit.id"
                         (click)="productForm.get('unit')?.setValue(unit.id)">
                      <span class="unit-symbol">{{ unit.symbol }}</span>
                      <span class="unit-name">{{ unit.name }}</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Estimation -->
              <div class="estimation-card" *ngIf="estimatedTotal > 0">
                <div class="estimation-icon">üìä</div>
                <div class="estimation-details">
                  <div class="estimation-label">Valeur totale estim√©e</div>
                  <div class="estimation-amount">{{ estimatedTotal.toLocaleString('fr-FR') }} FCFA</div>
                  <div class="estimation-breakdown">
                    {{ productForm.get('price')?.value || 0 }} FCFA √ó {{ productForm.get('quantity')?.value || 0 }} unit√©s
                  </div>
                </div>
              </div>
            </section>

            <!-- Section 3: Images -->
            <section id="images" class="form-section" [class.active]="currentSection === 'images'">
              <div class="section-header">
                <div class="section-icon">üì∏</div>
                <div class="section-title-group">
                  <h2 class="section-title">Photos du produit</h2>
                  <p class="section-subtitle">Une image vaut mille mots</p>
                </div>
              </div>

              <div class="images-section">
                <!-- Image principale -->
                <div class="main-image-upload">
                  <h4 class="upload-title">Photo principale</h4>
                  <p class="upload-subtitle">La premi√®re image que les acheteurs verront</p>

                  <div class="image-dropzone"
                       (click)="triggerImageUpload()"
                       [class.has-image]="mainImagePreview">
                    <input type="file"
                           #mainImageUpload
                           accept="image/*"
                           (change)="onMainImageSelected($event)"
                           class="hidden-input"
                           title="photo">

                    <div *ngIf="!mainImagePreview" class="dropzone-content">
                      <div class="dropzone-icon">
                        <svg width="48" height="48" viewBox="0 0 24 24">
                          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                      </div>
                      <p>Cliquez pour t√©l√©charger une photo</p>
                      <small>PNG, JPG, WebP - Max 5MB</small>
                    </div>

                    <div *ngIf="mainImagePreview" class="image-preview">
                      <img [src]="mainImagePreview" alt="Image principale">
                      <div class="image-actions">
                        <button type="button" class="image-action" (click)="triggerImageUpload()">
                          <i>üîÑ</i> Changer
                        </button>
                        <button type="button" class="image-action danger" (click)="removeMainImage()">
                          <i>üóëÔ∏è</i> Supprimer
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Images additionnelles -->
                <div class="additional-images">
                  <div class="additional-header">
                    <h4>Photos additionnelles</h4>
                    <span class="image-count">{{ additionalImages.length }}/4</span>
                  </div>

                  <div class="additional-grid">
                    <div *ngFor="let img of additionalImages; let i = index" class="additional-item">
                      <img [src]="img.preview" [alt]="'Photo ' + (i + 1)">
                      <button type="button" class="remove-image" (click)="removeAdditionalImage(i)">√ó</button>
                    </div>

                    <div *ngIf="additionalImages.length < 4"
                         class="add-more-card"
                         (click)="triggerAdditionalUpload()">
                      <div class="add-icon">+</div>
                      <span>Ajouter une photo</span>
                    </div>
                  </div>

                  <input type="file"
                         #additionalImagesUpload
                         accept="image/*"
                         multiple
                         (change)="onAdditionalImagesSelected($event)"
                         class="hidden-input"
                         title="file">
                </div>
              </div>
            </section>

            <!-- Section 4: Certifications -->
            <section id="certifications" class="form-section" [class.active]="currentSection === 'certifications'">
              <div class="section-header">
                <div class="section-icon">üèÜ</div>
                <div class="section-title-group">
                  <h2 class="section-title">Certifications</h2>
                  <p class="section-subtitle">Valorisez la qualit√© de votre produit</p>
                </div>
              </div>

              <div class="certifications-section">
                <div class="certifications-grid">
                  <div *ngFor="let cert of certifications"
                       class="certification-card"
                       [class.selected]="isCertificationSelected(cert.id)"
                       (click)="toggleCertification(cert.id)">
                    <div class="cert-icon">{{ cert.icon }}</div>
                    <div class="cert-info">
                      <h5>{{ cert.name }}</h5>
                      <p>{{ cert.description }}</p>
                    </div>
                    <div class="cert-check">
                      <div class="checkmark" [class.checked]="isCertificationSelected(cert.id)"></div>
                    </div>
                  </div>
                </div>

                <!-- Option Bio -->
                <div class="organic-toggle">
                  <label class="toggle-label">
                    <input type="checkbox" formControlName="isOrganic" class="toggle-input">
                    <div class="toggle-slider">
                      <span class="toggle-icon">üå±</span>
                      <span class="toggle-text">Produit biologique certifi√©</span>
                    </div>
                  </label>
                </div>
              </div>
            </section>

            <!-- Section 5: D√©tails suppl√©mentaires -->
            <section id="additional-details" class="form-section" [class.active]="currentSection === 'additional-details'">
              <div class="section-header">
                <div class="section-icon">üìù</div>
                <div class="section-title-group">
                  <h2 class="section-title">D√©tails suppl√©mentaires</h2>
                  <p class="section-subtitle">Informations compl√©mentaires pour les acheteurs</p>
                </div>
              </div>

              <div class="details-grid">
                <div class="form-group">
                  <label for="harvestDate" class="form-label">Date de r√©colte</label>
                  <div class="date-input">
                    <input type="date"
                           id="harvestDate"
                           formControlName="harvestDate"
                           class="form-control">
                    <i class="date-icon">üìÖ</i>
                  </div>
                </div>

                <div class="form-group">
                  <label for="expirationDate" class="form-label">Date d'expiration</label>
                  <div class="date-input">
                    <input type="date"
                           id="expirationDate"
                           formControlName="expirationDate"
                           class="form-control">
                    <i class="date-icon">‚è≥</i>
                  </div>
                </div>

                <div class="form-group">
                  <label for="storageConditions" class="form-label">Conditions de conservation</label>
                  <input type="text"
                         id="storageConditions"
                         formControlName="storageConditions"
                         placeholder="Ex: Conserver au frais entre 2¬∞C et 8¬∞C"
                         class="form-control">
                </div>

                <div class="form-group">
                  <label for="location" class="form-label">Lieu de production</label>
                  <div class="location-input">
                    <i class="location-icon">üìç</i>
                    <input type="text"
                           id="location"
                           formControlName="location"
                           placeholder="Ex: R√©gion de Thi√®s, S√©n√©gal"
                           class="form-control">
                  </div>
                </div>

                <div class="form-group">
                  <label for="contactPhone" class="form-label">Contact t√©l√©phonique</label>
                  <div class="phone-input">
                    <span class="phone-prefix">+221</span>
                    <input type="tel"
                           id="contactPhone"
                           formControlName="contactPhone"
                           placeholder="77 123 45 67"
                           class="form-control">
                  </div>
                </div>

                <div class="form-group">
                  <label for="minOrderQuantity" class="form-label">Quantit√© minimale</label>
                  <div class="quantity-input">
                    <input type="number"
                           id="minOrderQuantity"
                           formControlName="minOrderQuantity"
                           min="1"
                           value="1"
                           class="form-control">
                    <span class="quantity-label">unit√©s minimum</span>
                  </div>
                </div>
              </div>
            </section>
          </form>

          <!-- Actions en bas -->
          <div class="form-actions">
            <div class="actions-left">
              <button type="button"
                      class="action-btn secondary"
                      (click)="saveAsDraft()"
                      [disabled]="isSubmitting">
                <i class="btn-icon">üíæ</i>
                Sauvegarder comme brouillon
              </button>

              <button type="button"
                      class="action-btn outline"
                      (click)="showPreview()">
                <i class="btn-icon">üëÅÔ∏è</i>
                Pr√©visualiser
              </button>
            </div>

            <div class="actions-right">
              <button type="button"
                      class="action-btn secondary"
                      (click)="cancelForm()"
                      [disabled]="isSubmitting">
                Annuler
              </button>

              <button type="button"
                      class="action-btn primary"
                      [disabled]="isSubmitting || productForm.invalid"
                      (click)="validateAndSubmit()">
                <span *ngIf="!isSubmitting">
                  <i class="btn-icon">üöÄ</i>
                  Publier le produit
                </span>
                <span *ngIf="isSubmitting" class="loading">
                  <span class="spinner"></span>
                  Publication en cours...
                </span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
